<!DOCTYPE html>
<html lang="es">
  <head>
    <title>Bienvenido a mi E-Comerce!</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="assets/styles/newstyle.css" />
  </head>

  <body onload="initializePage()">
    <!-- barra de navegación con bootstrap -->
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
      <div class="container-fluid">
        <a class="navbar-brand brand-text" href="#">Mi E-Commerce</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="index.html">Inicio</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="product.html">Productos</a>
            </li>
            <!-- desplegable -->
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Consolas</a
              >
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#">Retro</a></li>
                <li><a class="dropdown-item" href="#">Portátiles</a></li>
                <!-- separacion de la lista -->
                <li><hr class="dropdown-divider" /></li>
                <li><a class="dropdown-item" href="#">Consolas Modernas</a></li>
              </ul>
            </li>
            <!-- elemento deshabilitado -->
            <li class="nav-item">
              <a class="nav-link" href="contact.html">Contacto</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="about.html">Acerca de</a>
            </li>
          </ul>
          <!-- barra de busqueda -->
          <form class="d-flex" role="search">
            <input
              class="form-control me-2"
              type="search"
              placeholder="Buscar"
              aria-label="Search"
            />
            <button class="btn btn-outline-success" type="submit">
              Buscar
            </button>
          </form>
        </div>
      </div>
    </nav>

    <hr />

    <div class="contenedor">
      <div class="hija">
        <h2>Productos en oferta</h2>
      </div>
    </div>

    <!-- <ul>
            <li>Home</li>
            <li>Productos</li>
            <li><a href="about.html" target="_self">Acerca de</a></li>
            <li><a href="contact.html" target="_self">Contacto</a></li>
        </ul> -->

    <!-- <nav style="--bs-breadcrumb-divider: url(&#34;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E&#34;);" aria-label="breadcrumb">
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="index.html">Inicio</a></li>
              <li class="breadcrumb-item"><a href="product.html">Productos</a></li>
              <li class="breadcrumb-item active" aria-current="page">Lista Productos</li>
            </ol>
        </nav> -->

    <div class="content">
      <div class="row gx-3" id="productList">
        
        <!-- <div class="collapse coll-text" id="atari2600">
          Lorem ipsum dolor sit amet consectetur, adipisicing elit.
          Asperiores, qui?
        </div>
        <a
          class="btn button-info"
          data-bs-toggle="collapse"
          href="#atari2600"
          >Mas información</a
        > -->
      </div>
    </div>

    <hr>

    <nav aria-label="Page navigation example">
      <ul class="pagination">
        <li class="page-item"><a class="page-link" href="#">Previous</a></li>
        <li class="page-item"><a class="page-link" href="#">1</a></li>
        <li class="page-item"><a class="page-link" href="#">2</a></li>
        <li class="page-item"><a class="page-link" href="#">3</a></li>
        <li class="page-item"><a class="page-link" href="#">Next</a></li>
      </ul>
    </nav>

    <div class="form-box">
      <div class="alert alert-success" role="alert" id="successMessage">
        Producto creado con éxito!
      </div>
      <div class="alert alert-danger" role="alert" id="errorMessage">
        Error al crear producto.
      </div>

      <h3 class="page-title">Crear nuevo producto</h3>
      <form id="create-form">
        <div class="mb-3">
          <label for="nombre" class="form-label label-text">Id producto:</label>
          <input
            type="text"
            class="form-control place-style"
            id="productId"
            name="productId"
            placeholder="Id"
          />
        </div>
        <div class="mb-3">
          <label for="nombre" class="form-label label-text">Nombre producto:</label>
          <input
            type="text"
            class="form-control place-style"
            id="productName"
            name="productName"
            placeholder="Nombre del producto"
          />
        </div>
        <div class="mb-3">
          <label for="nombre" class="form-label label-text">Descripción producto:</label>
          <input
            type="text"
            class="form-control place-style"
            id="productDesc"
            name="productDesc"
            placeholder="Descripción"
          />
        </div>
        <div class="mb-3">
          <label for="nombre" class="form-label label-text">Imagen producto:</label>
          <input
            type="text"
            class="form-control place-style"
            id="productImg"
            name="productImg"
            placeholder="URL de la imagen del producto"
          />
        </div>

        <button type="submit" class="btn btn-primary">Enviar</button>
        <p id="error-message" style="display: none; color: red">
          Por favor llenar todos los campos
        </p>
      </form>
    </div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
      integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
      crossorigin="anonymous"></script>
    <link rel="stylesheet" href="assets/styles/newstyle.css" />
    <script>
      let d = new Date();
      //alert(d);
      console.log(d);
      let atari_content = document.getElementById("atari2600");
      console.log(atari_content);
    </script>
    <script src="js/test-script.js"></script>

    <script>
      $(document).ready(function () {
        $("#successMessage").hide();
        $("#errorMessage").hide();

        
        $("#create-form").submit(function (event) {
          event.preventDefault();
          createProduct();
        });
        
        refreshProducts();
      });
    
      function refreshProducts() {
        $("#productList").html("");

        $.getJSON("http://127.0.0.1:9999/product", function(data){
          
          data.forEach((data) => {
            let productToAppend = `<div class="col-md">
            <div class="card card-style" style="width: 15rem">
              <img
                src="${data.image_url}"
                class="card-img-top"
                alt="${data.name}"
              />
              <div class="card-body">
                <h5 class="card-title">${data.name}</h5>
                <p class="card-text">
                  ${data.description}
                </p>
            
                <a href="#" class="btn btn-primary button-detail">Detalles</a>
                <!-- primary para indicar el color del boton -->
              </div>
            </div>`
            $("#productList").append(productToAppend);
          });
        });
      }
      
      function createProduct() {
        let productId = $("#productId").val();
        let productName = $("#productName").val();
        let productDesc = $("#productDesc").val();
        let productImg = $("#productImg").val();
        
        //Validaciones

        $.ajax({
          type: "POST",
          url: "http://localhost:9999/product",
          data: JSON.stringify({
            id: productId,
            name: productName,
            description: productDesc,
            image_url: productImg
          }),
          dataType: "json",
          processData: false,
          contentType: "application/json",
        }).done(function (data) {
          $("#successMessage").show()
        }).fail(function (data) {
          $("#errorMessage").show()
        });
      }
      
    </script>
  </body>
</html>
